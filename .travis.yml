language: python
python: 3.6
os:
  - linux
  - windows

install:
  # install the package and pyinstaller
  - pip install -r requirements.txt
  - pip install .
  - pip install pyinstaller

script:
  # compile
  - pyinstaller -F --add-data pmserver/templates:pmserver/templates serv.py

deploy:
  provider: releases
  api_key: $GITHUB_TOKEN
  skip_cleanup: false
  file:
    - dist/serv
    - dist/serv.exe
  on:
    tags: true
