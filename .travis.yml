language: python
python: 3.6
dist:
  - ubuntu
  - osx

install:
  - pip install -r requirements.txt
  - pip install .
  - pip install pyinstaller

script:
  - pyinstaller -F --add-data pmserver/templates:pmserver/templates serv.py
  - mv dist/serv dist/pmserver

deploy:
  provider: releases
  skip_cleanup: true
  api_key: $GITHUB_TOKEN
  file: dist/pmserver
  on:
    tags: true